self.onmessage=async e=>{const{id:i,...s}=e.data;for(const e of Object.keys(s))self[e]=s[e];try{let e;i<0?(importScripts(self.pyodide),self.pyodide=await loadPyodide(),await self.pyodide.loadPackage("micropip"),e=await self.pyodide.runPythonAsync("\n      import micropip\n      from js import packages, optlite\n      await micropip.install(optlite)\n      for p in packages:\n          await micropip.install(p)\n      ")):(await self.pyodide.loadPackagesFromImports(self.script),e=await self.pyodide.runPythonAsync("\n      import optlite\n      from js import script\n      optlite.exec_script(script)\n      ")),self.postMessage({results:e,id:i})}catch(e){self.postMessage({error:"Failed to run code: "+e.message,id:i})}};